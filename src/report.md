## Part 1. Инструмент **ipcalc**

### 1.1 Маски и сети

1) Адрес сети 192.167.38.54/13:
![](pictures/LN_1.1.png)
С помощью команды `ipcalc` 192.167.38.54/13 определяем адрес сети 192.160.0.0/13

2) Перевод маски:
- 255.255.255.0 в префиксную и двоичную запись:
![](pictures/LN_1.2.1.png)

- /15 в обычную и двоичную:
![](pictures/LN_1.2.2.png)

- 11111111.11111111.11111111.11110000 в обычную и префиксную:
![](pictures/LN_1.2.3.png)

* обычная форма записи *255.255.255.240*
* префиксная */28*

3) Минимальный и максимальный хост в сети 12.167.38.4 при масках: /8, 11111111.11111111.00000000.00000000, 255.255.254.0 и /4
![](pictures/LN_1.3.1.png)
![](pictures/LN_1.3.2.png)

### 1.2. localhost

- Определить и записать в отчёт, можно ли обратиться к приложению, работающему на localhost, со следующими IP: 194.34.23.100, 127.0.0.2, 127.1.0.1, 128.0.0.1

![](pictures/LN_localhost_1.png)

127.0.0.2, 127.1.0.1 - можем обратиться, т.к. диапазон 127.0.0.1 —127.255.255.254 - это стандартное, официально зарезервированное доменное имя для частных IP-адресов. Для сети, состоящей только из одного компьютера, как правило, используется всего один адрес — 127.0.0.1, который устанавливается на специальный сетевой интерфейс «внутренней петли» (англ. loopback) в сетевом протоколе TCP/IP.

![](pictures/LN_localhost_2.png)

194.34.23.100, 128.0.0.1 - не можем обратиться, т.к. находится за пределами хоста.

### 1.3. Диапазоны и сегменты сетей

#### 1.3.1. какие из перечисленных IP можно использовать в качестве публичного, а какие только в качестве частных: 10.0.0.45, 134.43.0.2, 192.168.4.2, 172.20.250.4, 172.0.2.1, 192.172.0.1, 172.68.0.2, 172.16.255.255, 10.10.10.10, 192.169.168.1

К частным адресам относятся IP-адреса, значения которых лежат в следующих диапазонах:
* 10.0.0.0 – 10.255.255.255 (10.0.0.0\8)
* 172.16.0.0 – 172.31.255.255 (172.16.0.0\12)
* 192.168.0.0 – 192.168.255.255 (192.168.0.0\16)

В качестве частных можем использовать:
* 10.0.0.45
* 10.10.10.10
* 172.20.250.4
* 172.16.255.255
* 192.168.4.2

![](pictures/LN_1_private_net_1.png)
![](pictures/LN_1_private_net_2.png)


В качестве публичных можем использовать:
* 134.43.0.2
* 172.0.2.1
* 172.68.0.2
* 192.172.0.1
* 192.169.168.1

![](pictures/LN_1_public_net_1.png)
![](pictures/LN_1_public_net_2.png)

#### 1.3.2. Какие из перечисленных IP адресов шлюза возможны у сети 10.10.0.0/18: 10.0.0.1, 10.10.0.2, 10.10.10.10, 10.10.100.1, 10.10.1.255

![](pictures/LN_Gateway.png)

* Возможные IP адреса шлюза:
10.10.0.2, 10.10.10.10, 10.10.1.255, т.к. они входят в диапазон адресов сети

    Шлюз (Gateway) – это сетевое устройство, предназначенное для объединения двух сетей (передачи между ними пользовательского трафика), которые обладают различными характеристиками, используют различные протоколы или технологии.

## Part 2. Статическая маршрутизация между двумя машинами

Поднимем две виртуальные машины (далее -- ws1 и ws2)

![](pictures/LN_vb_ws1_ws2.png)

С помощью команды `ip a` посмотрим существующие сетевые интерфейсы:

![](pictures/LN_ip%20a_ws1.png)
![](pictures/LN_ip%20a_ws2.png)

Вывод информации о сетевых интерфейсах с помощью команды `ip a` 

- Опишем сетевой интерфейс, соответствующий внутренней сети, на обеих машинах и зададим следующие адреса и маски: 
* ws1 - 192.168.100.10, маска /16,
* ws2 - 172.24.116.8, маска /12

Cодержание изменённого файла etc/netplan/00-installer-config.yaml для каждой машины:
![](pictures/LN_2_ws1.png)
![](pictures/LN_2_ws2.png)

Выполнить команду `netplan apply` для перезапуска сервиса сети:

![](pictures/LN_2_netplan_apply_ws1.png)
![](pictures/LN_2_netplan_apply_ws2.png)

Вызов и вывод после использованной команды `netplan apply`:

![](pictures/LN_after_netplan_apply_ws1.png)
![](pictures/LN_after_netplan_apply_ws2.png)

### 2.1. Добавление статического маршрута вручную

Добавим статический маршрут от одной машины до другой и обратно при помощи команды `ip r add`

![](pictures/LN_ip_r_add_ws1.png)
![](pictures/LN_ip_r_add_ws2.png)

Пропингуем соединение между машинами:
![](pictures/LN_2.1_ping_ws2.png)
![](pictures/LN_2.1_ping_ws1.png)

### 2.2. Добавление статического маршрута с сохранением

- Перезапустим машины:
![](pictures/LN2_2.2_reboot_ws1.png)
![](pictures/LN2_2.2_reboot_ws2.png)

- Добавим статический маршрут от одной машины до другой с помощью файла `etc/netplan/00-installer-config.yaml`

![](pictures/LN_2.2_yaml_ws1.png)
![](pictures/LN_2.2_yaml_ws2.png)

- Пингуем соединение между машинами:

![](pictures/LN_2.2_static_ping_ws1.png)
![](pictures/LN_2.2_static_ping_ws2.png)


## Part 3. Утилита **iperf3**

Скорость соединения проверяем с помощью утилиты iperf3:

Добавляем еще один сетевой адаптер в настройках виртуальных машин ws1 и ws2 для доступа в интернет, настраиваем его в файле `etc/netplan/00-installer-config.yaml`

![](pictures/LN_3.1_edit_yaml_to_install_iperf3.png)

![](pictures/LN_3.1_install_iperf3.png)

### 3.1. Скорость соединения

Разница между байтами в секунду (Б/с) и битами в секунду такая же, как разница между байтами и битами: 1 Б/с = 8 бит/с.

Точно так же разница между килобайтами в секунду (КБ/с) и Б/с такая же, как разница между килобайтами и байтами: 1 КБ/с = 1024 Б/с. И так далее.

Переведем 8 Mbps в MB/s, 100 MB/s в Kbps, 1 Gbps в Mbps:

    * 8 Mbps -> 1 MB/s
    * 100 MB/s -> 800000 Kbps
    * 1 Gbps -> 1024 Mbps

### 3.2. Утилита iperf3

Измерим скорость соединения между ws1 и ws2:

![](pictures/LN_3.2_iperf_server.png)
![](pictures/LN_3.2_iperf_client.png)


## Part 4. Сетевой экран

### 4.1. Утилита iptables

Создадим файл `/etc/firewall.sh`, имитирующий фаерволл, на ws1 и ws2:

![](pictures/LN_4.1_create_firewall_ws1.png)

![](pictures/LN_4.1_create_firewall_ws2.png)

Добавим в файл подряд следующие правила:

1) на ws1 применим стратегию, когда в начале пишется запрещающее правило, а в конце пишется разрешающее правило (это касается пунктов 4 и 5)
2) на ws2 применим стратегию, когда в начале пишется разрешающее правило, а в конце пишется запрещающее правило (это касается пунктов 4 и 5)
3) откроем на машинах доступ для порта 22 (ssh) и порта 80 (http)
4) запретим echo reply (машина не должна "пинговаться”, т.е. должна быть блокировка на OUTPUT)
5) разрешить echo reply (машина должна "пинговаться")

![](pictures/LN_.4.1_firewall_ws1_.png)
![](pictures/LN_.4.1_firewall_ws2_.png)

Запустим файлы на обеих машинах командами `chmod +x /etc/firewall.sh` и `/etc/firewall.sh`

![](pictures/LN_4.1_firewall_x_ws1.png)
![](pictures/LN_4.1_firewall_x_ws2.png)

Разница между стратегиями -  выполняется первое подходящее правило. Правила, которые применяются после, будут игнорироваться.

#### 4.2. Утилита nmap

Командой ping найдем машину, которая не "пингуется", после чего утилитой `nmap` покажем, что хост машины запущен

Проверка: в выводе nmap должно быть сказано: `Host is up`

![](pictures/LN_4.2_nmap_ws1.png)
![](pictures/LN_4.2_nmap_ws2.png)

Сохраним дампы образов виртуальных машин:

![](pictures/LN_4.2_snapshot_ws1.png)
![](pictures/LN_4.2_snapshot_ws2.png)
![](pictures/LN_4.2_finder_ws.png)

## Part 5. Статическая маршрутизация сети

Создаем пять виртуальных машин (3 рабочие станции (ws11, ws21, ws22) и 2 роутера (r1, r2)):

![](pictures/LN_5_five_vm.png)

### 5.1. Настройка адресов машин:

![](pictures/LN_5_net.png)

Настроиваем конфигурации машин в `etc/netplan/00-installer-config.yaml` согласно сети на рисунке

![](pictures/LN_5.1_w11_yml.png)
![](pictures/LN_5.1_w21_yml.png)
![](pictures/LN_5.1_w22_yml.png)
![](pictures/LN_5.1_r1_yml.png)
![](pictures/LN_5.1_r2_yml.png)

Перезапускаем сервис сети. Командой `ip -4 a` проверяем, что адреса машин задан верно:

![](pictures/LN_5.1_ip4a_w11.png)
![](pictures/LN_5.1_ip4a_w21.png)
![](pictures/LN_5.1_ip4a_w22.png)
![](pictures/LN_5.1_ip4a_r1.png)
![](pictures/LN_5.1_ip4a_r2.png)

Также пропингуем ws22 с ws21 и r1 с ws11:

![](pictures/LN_5.1_ping_ws22_from_ws21.png)
![](pictures/LN_5.1_ping_r1_from_ws11.png)

### 5.2. Включение переадресации IP-адресов

Для включения переадресации IP, выполним команду на роутерах:

`sysctl -w net.ipv4.ip_forward=1`

При таком подходе переадресация не будет работать после перезагрузки системы.

![](pictures/LN_5.2_ip_forward_r1.png)
![](pictures/LN_5.2_ip_forward_r2.png)

Откроем файл `/etc/sysctl.conf` и раскомментируем нужную строку. 

При таком подходе переадресация будет включена на постоянной основе:

![](pictures/LN_5.2_forwarding_r1.png)

![](pictures/LN_5.2_forwarding_r2.png)

### 5.3. Установка маршрута по-умолчанию

Настроиваем маршрут по-умолчанию (шлюз) для рабочих станций. Для этого добавляем `default` перед IP роутера в файле конфигураций

`etc/netplan/00-installer-config.yaml`

![](pictures/LN_5.3_config_ws11.png)
![](pictures/LN_5.3_config_ws21.png)
![](pictures/LN_5.3_config_ws22.png)

После изменений применяем команду `sudo netplan apply` для вступления в силу изменений

С помощью команды `ip r` убедимся, что маршрут добавился в таблицу маршрутизации

![](pictures/LN_5.3_static_ws11.png)
![](pictures/LN_5.3_static_ws21.png)
![](pictures/LN_5.3_static_ws22.png)

Пропингуем с ws11 роутер r2, пинг не пройдёт, т.к. роутер "не знает" куда вернуть ответ, при этом передача пакетов с машины осуществляется.

Запускаем на r2 утилиту `tcpdump`, которая позволяет прослушать порты и вывести на экран информацию с каких IP адресов приходят пакеты. В данном случае слушаем интерфейс enp0s8

![](pictures/LN_5.3_ping_ws11.png)
![](pictures/LN_5.3_ping_tcpdump_r2.png)

### 5.4. Добавление статических маршрутов

Добавим в роутеры r1 и r2 статические маршруты в файле конфигураций

`etc/netplan/00-installer-config.yaml`

Для применения изменений используем команду `sudo netplan apply`

![](pictures/LN_5.4_static_r1.png)
![](pictures/LN_5.4_static_r2.png)

Вызовем `ip r` и посмотрим таблицы с маршрутами на обоих роутерах:

10.20.0.0/26 через 10.100.0.12 устройство enp0s9
![](pictures/LN_5.4_table_with_routes_r1.png)

10.10.0.0/18 через 10.100.0.11 устройство enp0s8
![](pictures/LN_5.4_table_with_routes_r2.png)

Запустим команды на ws11:
- `ip r list 10.10.0.0/18`
- `ip r list 0.0.0.0/0`

![](pictures/LN_5.4_ws11.png)

Для адреса 10.10.0.0/18 был выбран маршрут, отличный от 0.0.0.0/0 (он попадает под маршрут по-умолчанию), т.к. машина ws11 соединена с сетью 10.10.0.0/18 по своему IP-адресу 10.10.0.2, для других адресов используется маршрут по умолчанию, который указан в файле 10.10.0.1.

### 5.5. Построение списка маршрутизаторов

Запустим на r1 команду дампа:

`tcpdump -tnv -i enp0s8`
- `-n` - не конвертировать адреса в имена;
- `-t` - не выводить время при выводе каждой строчки дампа;
- `-v` - выводить более подробную информацию. Например, печатаются время создания, общая длина и параметры IP-пакета. Также включает дополнительные проверки целостности пакетов, такие как проверка контрольной суммы заголовка IP и ICMP.

![](pictures/LN_5.5_dump_r1.png)

При помощи утилиты `traceroute` построим список маршрутизаторов на пути от ws11 до ws21:

![](pictures/LN_5.5_traceroute_ws11_ws21.png)

Каждый пакет проходит на своем пути определенное количество узлов, пока достигнет своей цели. Причем, каждый пакет имеет свое время жизни. Это количество узлов, которые может пройти пакет перед тем, как он будет уничтожен. Этот параметр записывается в заголовке TTL, каждый маршрутизатор, через который будет проходить пакет уменьшает его на единицу. При TTL=0 пакет уничтожается, а отправителю отсылается сообщение Time Exceeded.

Команда traceroute linux использует UDP пакеты. Она отправляет пакет с TTL=1 и смотрит адрес ответившего узла, дальше TTL=2, TTL=3 и так пока не достигнет цели. Каждый раз отправляется по три пакета и для каждого из них измеряется время прохождения. Пакет отправляется на случайный порт, который, скорее всего, не занят. Когда утилита traceroute получает сообщение от целевого узла о том, что порт недоступен трассировка считается завершенной.

###  5.6. Использование протокола ICMP при маршрутизации

Запустить на r1 перехват сетевого трафика, проходящего через `enp0s8` с помощью команды:

`sudo tcpdump -n -i enp0s8 icmp`

![](pictures/LN_5.6_tcpdump_r1.png)

Пропингуем с ws11 несуществующий IP (например, 10.30.0.111) с помощью команды:
ping -c 5 10.30.0.111

![](pictures/LN_5.6_ping_w11.png)

Сохраняем дампы образов виртуальных машин

![](pictures/LN_5.6_dump_r1.png)
![](pictures/LN_5.6_dump_r2.png)
![](pictures/LN_5.6_dump_w11.png)
![](pictures/LN_5.6_dump_w21.png)
![](pictures/LN_5.6_dump_w22.png)

## Part 6. Динамическая настройка IP с помощью **DHCP**

Для r2 настроим в файле `/etc/dhcp/dhcpd.conf` конфигурацию службы DHCP:

1) укажем адрес маршрутизатора по-умолчанию, DNS-сервер и адрес внутренней сети:

![](pictures/LN_6_dhcpd_r2.png)

2) в файле resolv.conf пропишем `nameserver 8.8.8.8`

Содержит адреса серверов имен, к которым имеет доступ данная система

![](pictures/LN_6_resolv_r2.png)

Перезагрузим службу DHCP командой `systemctl restart isc-dhcp-server`

![](pictures/LN_6_restart_dhcp_r2.png)

Машину ws21 перезагрузим при помощи `reboot` и через `ip a` посмотрим, что она получила адрес. Также пропингуем ws22 с ws21.

Изменим настройки машин ws21 и ws22 в файле конфигурации, чтобы сделать протокол DHCP активным.

`sudo nano /etc/netplan/
00-installer-config.yaml`

`sudo netplan apply`

![](pictures/LN_6_dhcp_ws21.png)

![](pictures/LN_6_dhcp_ws22.png)

Перезагружаем виртуальную машину ws21

`sudo systemctl reboot`

Проверяем присвоенный устройствам адрес командой `ip a`

![](pictures/LN_6_ip_a_ws21.png)
![](pictures/LN_6_ip_a_ws22.png)

Пробуем пропинговать ws22 с ws21:

![](pictures/LN_6_ping_ws22.png)

Укажем MAC адрес у ws11, для этого в  `etc/netplan/00-installer-config.yaml` надо добавить строки: `macaddress: 10:10:10:10:10:BA`, `dhcp4: true`

![](pictures/LN_6_macaddress_ws11.png)

Теперь необходимо выключить машину ws11 и в менеджере виртуальных машин VirtualBox также изменить macaddress:

![](pictures/LN_6_macaddress_vb_ws11.png)

Для r1 настроим аналогично r2, но сделаем выдачу адресов с жесткой привязкой к MAC-адресу (ws11)

Отредактируем файл
`sudo nano /etc/dhcp/dhcpd.conf`

![](pictures/LN_6_dhcpd_r1.png)

Отредактируем файл 
`sudo nano /etc/resolv.conf`

![](pictures/LN_6_resolv_r1.png)

Перезапустим `systemctl restart isc-dhcp-server`

![](pictures/LN_6_restart_dhcp_r1.png)

Проводим аналогичные тесты - проверяем какой адрес назначен машине ws11

![](pictures/LN_6_ip_a_ws11.png)

Пропингуем ws21 c ws22

![](pictures/LN_6_ping_ws11_ws22.png)

Запросим с ws21 обновление ip адреса

Обновление ip адреса производится с помощью команды `sudo dhclient`

Посмотрим IP до обновления

![](pictures/LN_6_dhclient_before_ws21.png)

Запросим с ws21 обновление ip адреса с помощью команды `sudo dhclient -v`

- `v` - будет выведена дополнительная информация

![](pictures/LN_6_dhclient_update_ws21.png)

Проверяем измения командой `ip a`

![](pictures/LN_6_dhclient_after_ws21.png)

В части 6 были использованы следующие опции `DHCP` протокола:

`option routers ip-address [, ip-address...];` - адреса шлюзов для клиентской сети. Маршрутизаторы должны быть перечислены в порядке предпочтительности.

`option domain-name-servers ip-address [, ip-address...];` - Список DNS серверов доступных клиенту. Сервера должны быть перечислены в порядке предпочтительности.

Сохраняем дампы образов виртуальных машин

![](pictures/LN_6_snapshot_ws11.png)
![](pictures/LN_6_snapshot_ws21.png)
![](pictures/LN_6_snapshot_ws22.png)
![](pictures/LN_6_snapshot_r1.png)
![](pictures/LN_6_snapshot_r2.png)

## Part 7. **NAT**

Для работы с сервером `apache2`, установим его на машины r1, r2 и ws22 следующей командой

`sudo apt install apache2`

В файле `/etc/apache2/ports.conf` на ws22 и r1 изменим строку `Listen 80` на `Listen 0.0.0.0:80`, то есть сделаем сервер Apache2 общедоступным

![](pictures/LN_7_apache2_port80_r1.png)
![](pictures/LN_7_apache2_port80_ws22.png)

Запустим веб-сервер Apache командой service `apache2 start` на ws22 и r1

Статус можно проверить командой 
`sudo systemctl status apache2`

![](pictures/LN_7_apache_start_status_r1.png)
![](pictures/LN_7_apache_start_status_ws22.png)

Добавим в фаервол, созданный по аналогии с фаерволом из Части 4, на r2 следующие правила:

1) Удаление правил в таблице filter - `iptables -F`
2) Удаление правил в таблице "NAT" - `iptables -F -t nat`
3) Отбрасывать все маршрутизируемые пакеты - `iptables --policy FORWARD DROP`

![](pictures/LN_7_firewall_r2.png)
![](pictures/LN_7_firewall_exec_r2.png)

При запуске файла `firewall.sh` с этими правилами, ws22 не должна "пинговаться" с r1.

Проверим соединение между r1 и ws22

![](pictures/LN_7_ping_r1_ws22.png)

Проверим соединение между r1 и ws22

![](pictures/LN_7_ping_ws22_r1.png)

Добавим в файл ещё одно правило:

- Разрешить маршрутизацию всех пакетов протокола ICMP, для этого прописываем правило для протокола icmp и цепочки FORWARD

`sudo nano /etc/apache2/ports.conf`

![](pictures/LN_7_icmp_firewall_r2.png)

![](pictures/LN_7_icmp_firewall_exec_r2.png)

Проверим соединение между ws22 и r1 командой `ping`

При запуске файла `firewall.sh` с этими правилами, ws22 должна "пинговаться" с r1

![](pictures/LN_7_pin_ws22_to_r1.png)

Добавим в файл ещё два правила:

5) Включаем `SNAT`, а именно маскирование всех локальных ip из локальной сети, находящейся за r2 (по обозначениям из Части 5 - сеть 10.20.0.0)

6) Включаем `DNAT` на 8080 порт машины r2 и добавляем к веб-серверу Apache, запущенному на ws22, доступ извне сети

![](pictures/LN_7_add_rules_firewall_r2.png)

Значения использованных опций:

- t - указывает на используемую таблицу;
- p - указывает протокол, такие как tcp, udp, udplite и другие, поддерживаемые системой, ознакомиться со списком можно в файле /etc/protocols;
- s - указывает адрес источника пакета, в качестве значения можно указать как один IP-адрес, так и диапазон;
- --dport - порт получателя пакета;

`DNAT` — подменяет адрес получателя в заголовке IP-пакета, основное применение — предоставление доступа к сервисам снаружи, находящимся внутри сети;

`SNAT` — служит для преобразования сетевых адресов, применимо, когда за сервером находятся машины, которым необходимо предоставить доступ в Интернет, при этом от провайдера имеется статический IP-адрес

![](pictures/LN_7_exec2_firewall_r2.png)

Проверяем соединение по TCP для `SNAT`, для этого с ws22 подключаемся к серверу Apache на r1 командой `telnet [адрес] [порт]`

![](pictures/LN_7_SNAT_w22.png)

Проверим соединение по TCP для `DNAT`, для этого с r1 подключимся к серверу Apache на ws22 командой `telnet` (обращаться по адресу r2 и порту 8080)

![](pictures/LN_7_DNAT_r1.png)

Сохраняем дампы образов виртуальных машин

![](pictures/LN_7_snapshot_ws11.png)
![](pictures/LN_7_snapshot_ws21.png)
![](pictures/LN_7_snapshot_ws22.png)
![](pictures/LN_7_snapshot_r1.png)
![](pictures/LN_7_snapshot_r2.png)


## Part 8. Дополнительно. Знакомство с **SSH Tunnels**

Запустим на r2 фаервол с правилами из Части 7

![](pictures/LN_8_exec_firewall_r2.png)

Запустим веб-сервер Apache на ws22 только на `localhost` (то есть в файле `/etc/apache2/ports.conf` изменим строку `Listen 80` на `Listen localhost:80`)

![](pictures/LN_8_sshd_ws22.png)
![](pictures/LN_8_localhost_22.png)

Воспользуемся `Local TCP forwarding` с ws21 до ws22, чтобы получить доступ к веб-серверу на ws22 с ws21

Переадресация локального порта позволяет перенаправить порт на локальном компьютере (клиент ssh) на порт на удаленном компьютере (сервер ssh), который затем перенаправляется на порт на компьютере назначения. В этом типе переадресации клиент SSH прослушивает заданный порт и туннелирует любое подключение к этому порту к указанному порту на удаленном сервере SSH, который затем подключается к порту на целевом компьютере. Конечным компьютером может быть удаленный SSH-сервер или любой другой компьютер.

Устанавливаем соединение с сервером ws22 от машины ws21

`ssh -L 8080:localhost:80 10.20.0.20`

![](pictures/LN_8_Local_TCP_ws21_to_ws22.png)

Воспользуемся `Remote TCP forwarding` c ws11 до ws22, чтобы получить доступ к веб-серверу на ws22 с ws11

Переадресация удаленного порта противоположна переадресации локального порта. Это позволяет перенаправить порт на удалённом компьютере (сервер ssh) на порт на локальном компьютере (клиент ssh), который затем перенаправляется на порт на компьютере назначения. В этом типе переадресации сервер SSH прослушивает заданный порт и туннелирует любое соединение с этим портом на указанный порт локального клиента SSH, который затем подключается к порту на целевом компьютере. Машина назначения может быть локальной или любой другой машиной. Удаленное перенаправление портов в основном используется для предоставления доступа к внутренней службе кому-то извне.

![](pictures/LN_8_Remote_TCP_ws11_to_ws22.png)

Для проверки, сработало ли подключение в обоих предыдущих пунктах, перейдите во второй терминал (например, клавишами Alt + F2) и выполните команду:
`telnet 127.0.0.1 [локальный порт]`

ws11:
![](pictures/LN_8_telnet_ws11.png)

ws21:
![](pictures/LN_8_telnet_ws21.png)

Сохраняем дампы образов виртуальных машин

![](pictures/LN_8_snapshot_ws11.png)
![](pictures/LN_8_snapshot_ws21.png)
![](pictures/LN_8_snapshot_ws22.png)
![](pictures/LN_8_snapshot_r1.png)
![](pictures/LN_8_snapshot_r2.png)